---

title: ml


keywords: fastai
sidebar: home_sidebar

summary: "data processing and model training + analysis using machine learning"
description: "data processing and model training + analysis using machine learning"
nb_path: "03_ml.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_ml.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/ml.html"><code>ml</code></a> contains the code base to process glycan for machine learning, construct state-of-the-art machine learning models, train them, and analyze trained models + glycan reprsentations. It currently contains the following modules:</p>
<ul>
<li><code>model_training</code> contains functions for training machine learning models</li>
<li><code>models</code> describes some examples for machine learning architectures applicable to glycans</li>
<li><code>processing</code> contains helper functions to prepare glycan data for model training</li>
<li><code>representation</code> can be used to analyze trained models and to obtain glycan representations</li>
<li><code>train_test_split</code> contains various data split functions to get appropriate training and test sets</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="model_training">model_training<a class="anchor-link" href="#model_training"> </a></h1><blockquote><p>contains functions for training machine learning models</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(EarlyStopping)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(train_model)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(init_weights)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(prep_model)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(training_setup)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="models">models<a class="anchor-link" href="#models"> </a></h1><blockquote><p>describes some examples for machine learning architectures applicable to glycans</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(SweetNet)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="processing">processing<a class="anchor-link" href="#processing"> </a></h1><blockquote><p>contains helper functions to prepare glycan data for model training</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(dataset_to_graphs)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(dataset_to_dataloader)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(split_data_to_train)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="representation">representation<a class="anchor-link" href="#representation"> </a></h1><blockquote><p>can be used to analyze trained models and to obtain glycan representations</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show_doc(glycans_to_emb)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="train_test_split">train_test_split<a class="anchor-link" href="#train_test_split"> </a></h1><blockquote><p>contains various data split functions to get appropriate training and test sets</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span><span class="p">,</span> <span class="n">val_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">val_y</span><span class="p">,</span> <span class="n">id_val</span><span class="p">,</span> <span class="n">class_list</span><span class="p">,</span> <span class="n">class_converter</span> <span class="o">=</span> <span class="n">hierarchy_filter</span><span class="p">(</span><span class="n">df_species</span><span class="p">,</span>
                                                                                       <span class="n">rank</span> <span class="o">=</span> <span class="s1">&#39;Kingdom&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_x</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Man(a1-3)[Galf(a1-4)]Man&#39;, &#39;Man(a1-3)Man(a1-6)Man(b1-4)GlcNAc(b1-4)GlcNAcN&#39;, &#39;Neu5Gc(a2-3)Gal(b1-4)GlcNAc(b1-3)Gal(b1-4)GlcNAc(b1-3)Gal(b1-3)Glc&#39;, &#39;D-FucNAcNMeN(b1-6)LDManHep(a1-4)GlcN(a1-4)[GalAN(a1-6)]Glc(b1-4)[GlcA(b1-2)[GlcN(a1-7)]LDManHepOP(a1-3)]LDManHep(a1-5)KdoOP(a2-6)GlcOPN(b1-6)GlcOPN&#39;, &#39;Rha(a1-2)[Araf(a1-3)]Glc&#39;, &#39;GalANSerAc(a1-4)GalN(a1-4)GalA(a1-4)GlcN&#39;, &#39;Fuc(a1-3)[Gal(b1-4)]GlcNAc(b1-2)Man(a1-3)[Fuc(a1-3)[Gal(b1-4)]GlcNAc(b1-2)Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;, &#39;[Abe(a1-3)]Man(a1-2)Man(a1-2)Man(b1-3)GalNAc(a1-6)Man&#39;, &#39;6dTalOAc(a1-3)6dTal(a1-2)Rha(a1-2)6dTalOAc&#39;, &#39;Man(a1-3)Man(a1-6)[Xyl(b1-2)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-3)]GlcNAc&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span><span class="p">,</span> <span class="n">val_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">val_y</span><span class="p">,</span> <span class="n">id_val</span><span class="p">,</span> <span class="n">class_list</span><span class="p">,</span> <span class="n">class_converter</span> <span class="o">=</span> <span class="n">hierarchy_filter</span><span class="p">(</span><span class="n">df_species</span><span class="p">,</span>
                                                                                       <span class="n">rank</span> <span class="o">=</span> <span class="s1">&#39;Kingdom&#39;</span><span class="p">,</span>
                                                                                       <span class="n">wildcard_seed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                                                       <span class="n">wildcard_list</span> <span class="o">=</span> <span class="n">linkages</span><span class="p">,</span>
                                                                                       <span class="n">wildcard_name</span> <span class="o">=</span> <span class="s1">&#39;bond&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_x</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;GlcOAc(bond)Glc(b1-2)GlcOAc&#39;, &#39;Neu5Ac(a2-3)Gal(bond)GlcNAc(b1-2)Man(a1-3)[Man(a1-3)[Man(a1-6)]Man(a1-6)]Man(bond)GlcNAc(bond)[Fuc(a1-6)]GlcNAc&#39;, &#39;Man(bond)[Man(a1-6)]Man(a1-6)[GlcNAc(b1-2)Man(bond)][Xyl(b1-2)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;, &#39;Man(a1-3)[Man(a1-6)]Man(a1-6)[GlcNAc(b1-2)Man(a1-3)][Xyl(b1-2)]Man(bond)GlcNAc(bond)GlcNAc&#39;, &#39;QuiNBut(b1-6)[Glc(a1-4)]Glc(a1-4)GlcA(bond)GlcNAc(b1-2)QuiNBut&#39;, &#39;QuiNBut(bond)[Glc(a1-4)]Glc(a1-4)GlcA(b1-3)GlcNAc(b1-2)QuiNBut&#39;, &#39;RhaOMe(bond)RhaOMe(a1-4)RhaOMe&#39;, &#39;Gal(a1-6)Man(bond)Man(bond)Man(bond)Man&#39;, &#39;GalNAc(b1-4)[Neu5Ac(bond)]Gal(b1-4)GlcNAc(b1-6)[GalOS(b1-4)GlcNAc(b1-2)]Man(a1-6)[GalOS(b1-4)GlcNAc(b1-2)[GalOS(b1-4)GlcNAc(b1-4)]Man(a1-3)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;, &#39;Glc(a1-4)[Rha(bond)]GlcA(b1-3)GlcNAc(bond)Rha(a1-6)Glc&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span><span class="p">,</span> <span class="n">val_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">val_y</span> <span class="o">=</span> <span class="n">general_split</span><span class="p">(</span><span class="n">df_species</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                                              <span class="n">df_species</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_x</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;[GalNAc(a1-2)]QuiNBut(b1-4)[GalNAc(a1-2)]QuiNBut(b1-4)QuiNBut(b1-4)QuiNBut&#39;, &#39;GlcN(a1-6)Man(a1-3)[GlcN(a1-6)Man(a1-6)]Man(a1-5)Kdo(a2-6)GlcOPN(b1-6)GlcOPN&#39;, &#39;Glc(b1-4)Man(b1-4)Man&#39;, &#39;Gal(a1-2)Glc(a1-2)Fruf&#39;, &#39;[Man(a1-2)]Man(a1-6)[D-Araf(a1-2)Man(a1-2)]Man(a1-6)[D-Araf(a1-2)]Man(a1-6)Man(a1-6)Man&#39;, &#39;[GalOPyr(b1-6)]GlcNAc(a1-3)QuiNAc(b1-3)[GalOPyr(b1-6)]GalNAc(b1-3)GlcNAc&#39;, &#39;ManNAcNAmA(b1-4)L-GulNAcA(a1-3)D-FucNAc&#39;, &#39;Rha(a1-4)Xyl(b1-2)[Glc(b1-3)]Glc(b1-4)Gal&#39;, &#39;Man(a1-3)[Man(b1-4)Xyl(b1-4)Xyl(b1-6)][GlcA(b1-2)]Man(a1-3)Man(a1-3)Man&#39;, &#39;Gal(b1-4)GlcNAc(b1-2)Man(a1-3)[Gal(b1-4)GlcNAc(b1-2)Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

