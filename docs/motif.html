---

title: motif


keywords: fastai
sidebar: home_sidebar

summary: "Processing and analyzing glycan sequences on a motif-basis"
description: "Processing and analyzing glycan sequences on a motif-basis"
nb_path: "04_motif.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_motif.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/glycowork/motif.html"><code>motif</code></a> contains many functions to process glycans in various ways and use this processing analyze glycans via curated motifs, graph features, and sequence features. It contains the following modules:</p>
<ul>
<li><code>analysis</code> contains functions for downstream analyses of important glycan motifs etc.</li>
<li><code>annotate</code> contains functions to extract curated motifs, graph features, and sequence features from glycan sequences</li>
<li><code>graph</code> is used to convert glycan sequences to graphs and contains helper functions to search for motifs / check whether two sequences describe the same sequence, etc.</li>
<li><code>processing</code> contains all the basic functions to process IUPACcondensed glycan sequences into glycoletters etc. Also contains <code>get_lib</code> to construct the glycoletter library</li>
<li><code>query</code> is used to interact with the databases contained in glycowork, delivering insights for sequences of interest</li>
<li><code>tokenization</code> has helper functions to map glycans (strings) to numbers that can be used by models</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="analysis">analysis<a class="anchor-link" href="#analysis"> </a></h1><blockquote><p>downstream analyses of important glycan motifs</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_pvals_motifs" class="doc_header"><code>get_pvals_motifs</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/analysis.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_pvals_motifs</code>(<strong><code>df</code></strong>, <strong><code>glycan_col_name</code></strong>=<em><code>'glycan'</code></em>, <strong><code>label_col_name</code></strong>=<em><code>'target'</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>thresh</code></strong>=<em><code>1.645</code></em>, <strong><code>sorting</code></strong>=<em><code>True</code></em>, <strong><code>feature_set</code></strong>=<em><code>['exhaustive']</code></em>, <strong><code>extra</code></strong>=<em><code>'termini'</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>, <strong><code>multiple_samples</code></strong>=<em><code>False</code></em>, <strong><code>motifs</code></strong>=<em><code>None</code></em>, <strong><code>estimate_speedup</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>returns enriched motifs based on label data or predicted data</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">df (dataframe): dataframe containing glycan sequences and labels</td>
</tr>
<tr>
<td style="text-align:left">glycan_col_name (string): column name for glycan sequences; arbitrary if multiple_samples = True; default:'glycan'</td>
</tr>
<tr>
<td style="text-align:left">label_col_name (string): column name for labels; arbitrary if multiple_samples = True; default:'target'</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
<tr>
<td style="text-align:left">thresh (float): threshold value to separate positive/negative; default is 1.645 for Z-scores</td>
</tr>
<tr>
<td style="text-align:left">sorting (bool): whether p-value dataframe should be sorted ascendingly; default: True</td>
</tr>
<tr>
<td style="text-align:left">feature_set (list): which feature set to use for annotations, add more to list to expand; default is 'exhaustive'; options are: 'known' (hand-crafted glycan features), 'graph' (structural graph features of glycans) and 'exhaustive' (all mono- and disaccharide features)</td>
</tr>
<tr>
<td style="text-align:left">extra (string): 'ignore' skips this, 'wildcards' allows for wildcard matching', and 'termini' allows for positional matching; default:'termini'</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of wildcard names (such as 'bond', 'Hex', 'HexNAc', 'Sia')</td>
</tr>
<tr>
<td style="text-align:left">multiple_samples (bool): set to True if you have multiple samples (rows) with glycan information (columns); default:False</td>
</tr>
<tr>
<td style="text-align:left">motifs (dataframe): can be used to pass a modified motif_list to the function; default:None</td>
</tr>
<tr>
<td style="text-align:left">estimate_speedup (bool): if True, pre-selects motifs for those which are present in glycans, not 100% exact; default:False</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe with p-values and corrected p-values for every glycan motif</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glycans</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)][Xyl(b1-2)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-3)]GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Man(a1-2)Man(a1-2)Man(a1-3)[Man(a1-3)Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;GalNAc(a1-4)GlcNAcA(a1-4)[GlcN(b1-7)]Kdo(a2-5)[Kdo(a2-4)]Kdo(a2-6)GlcOPN(b1-6)GlcOPN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Man(a1-2)Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Glc(b1-3)Glc(b1-3)Glc&#39;</span><span class="p">]</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.234</span><span class="p">,</span> <span class="mf">2.423</span><span class="p">,</span> <span class="mf">0.733</span><span class="p">,</span> <span class="mf">3.102</span><span class="p">,</span> <span class="mf">0.108</span><span class="p">]</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;glycan&#39;</span><span class="p">:</span><span class="n">glycans</span><span class="p">,</span> <span class="s1">&#39;binding&#39;</span><span class="p">:</span><span class="n">label</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Glyco-Motif enrichment p-value test&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">get_pvals_motifs</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="s1">&#39;glycan&#39;</span><span class="p">,</span> <span class="s1">&#39;binding&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_heatmap" class="doc_header"><code>make_heatmap</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/analysis.py#L76" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_heatmap</code>(<strong><code>df</code></strong>, <strong><code>mode</code></strong>=<em><code>'sequence'</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>feature_set</code></strong>=<em><code>['known']</code></em>, <strong><code>extra</code></strong>=<em><code>'termini'</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>, <strong><code>datatype</code></strong>=<em><code>'response'</code></em>, <strong><code>rarity_filter</code></strong>=<em><code>0.05</code></em>, <strong><code>filepath</code></strong>=<em><code>''</code></em>, <strong><code>index_col</code></strong>=<em><code>'target'</code></em>, <strong><code>estimate_speedup</code></strong>=<em><code>False</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>clusters samples based on glycan data (for instance glycan binding etc.)</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">df (dataframe): dataframe with glycan data, rows are samples and columns are glycans</td>
</tr>
<tr>
<td style="text-align:left">mode (string): whether glycan 'sequence' or 'motif' should be used for clustering; default:sequence</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
<tr>
<td style="text-align:left">feature_set (list): which feature set to use for annotations, add more to list to expand; default is 'exhaustive'; options are: 'known' (hand-crafted glycan features), 'graph' (structural graph features of glycans) and 'exhaustive' (all mono- and disaccharide features)</td>
</tr>
<tr>
<td style="text-align:left">extra (string): 'ignore' skips this, 'wildcards' allows for wildcard matching', and 'termini' allows for positional matching; default:'termini'</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of wildcard names (such as 'bond', 'Hex', 'HexNAc', 'Sia')</td>
</tr>
<tr>
<td style="text-align:left">datatype (string): whether df comes from a dataset with quantitative variable ('response') or from presence_to_matrix ('presence')</td>
</tr>
<tr>
<td style="text-align:left">rarity_filter (float): proportion of samples that need to have a non-zero value for a variable to be included; default:0.05</td>
</tr>
<tr>
<td style="text-align:left">filepath (string): absolute path including full filename allows for saving the plot</td>
</tr>
<tr>
<td style="text-align:left">index_col (string): default column to convert to dataframe index; default:'target'</td>
</tr>
<tr>
<td style="text-align:left">estimate_speedup (bool): if True, pre-selects motifs for those which are present in glycans, not 100% exact; default:False</td>
</tr>
<tr>
<td style="text-align:left">**kwargs: keyword arguments that are directly passed on to seaborn clustermap</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Prints clustermap                         </td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glycans</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)][Xyl(b1-2)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-3)]GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Man(a1-2)Man(a1-2)Man(a1-3)[Man(a1-3)Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;GalNAc(a1-4)GlcNAcA(a1-4)[GlcN(b1-7)]Kdo(a2-5)[Kdo(a2-4)]Kdo(a2-6)GlcN4P(b1-6)GlcN4P&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Man(a1-2)Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Glc(b1-3)Glc(b1-3)Glc&#39;</span><span class="p">]</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.234</span><span class="p">,</span> <span class="mf">2.423</span><span class="p">,</span> <span class="mf">0.733</span><span class="p">,</span> <span class="mf">3.102</span><span class="p">,</span> <span class="mf">0.108</span><span class="p">]</span>
<span class="n">label2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.134</span><span class="p">,</span> <span class="mf">0.345</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">0.233</span><span class="p">,</span> <span class="mf">2.981</span><span class="p">]</span>
<span class="n">label3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.334</span><span class="p">,</span> <span class="mf">0.245</span><span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">0.133</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">]</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">label</span><span class="p">,</span> <span class="n">label2</span><span class="p">,</span> <span class="n">label3</span><span class="p">],</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">glycans</span><span class="p">)</span>

<span class="n">make_heatmap</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">make_heatmap</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;motif&#39;</span><span class="p">,</span> <span class="n">feature_set</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;known&#39;</span><span class="p">,</span> <span class="s1">&#39;exhaustive&#39;</span><span class="p">],</span> <span class="n">estimate_speedup</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_embeddings" class="doc_header"><code>plot_embeddings</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/analysis.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_embeddings</code>(<strong><code>glycans</code></strong>, <strong><code>emb</code></strong>=<em><code>None</code></em>, <strong><code>label_list</code></strong>=<em><code>None</code></em>, <strong><code>shape_feature</code></strong>=<em><code>None</code></em>, <strong><code>filepath</code></strong>=<em><code>''</code></em>, <strong><code>alpha</code></strong>=<em><code>0.8</code></em>, <strong><code>palette</code></strong>=<em><code>'colorblind'</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>plots glycan representations for a list of glycans</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycans (list): list of IUPAC-condensed glycan sequences as strings</td>
</tr>
<tr>
<td style="text-align:left">emb (dictionary): stored glycan representations; default takes them from trained species-level SweetNet model</td>
</tr>
<tr>
<td style="text-align:left">label_list (list): list of same length as glycans if coloring of the plot is desired</td>
</tr>
<tr>
<td style="text-align:left">shape_feature (string): monosaccharide/bond used to display alternative shapes for dots on the plot</td>
</tr>
<tr>
<td style="text-align:left">filepath (string): absolute path including full filename allows for saving the plot</td>
</tr>
<tr>
<td style="text-align:left">alpha (float): transparency of points in plot; default:0.8</td>
</tr>
<tr>
<td style="text-align:left">palette (string): color palette to color different classes; default:'colorblind'</td>
</tr>
<tr>
<td style="text-align:left">**kwargs: keyword arguments that are directly passed on to matplotlib</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_fabales</span> <span class="o">=</span> <span class="n">df_species</span><span class="p">[</span><span class="n">df_species</span><span class="o">.</span><span class="n">Order</span> <span class="o">==</span> <span class="s1">&#39;Fabales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plot_embeddings</span><span class="p">(</span><span class="n">df_fabales</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">label_list</span> <span class="o">=</span> <span class="n">df_fabales</span><span class="o">.</span><span class="n">Family</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="characterize_monosaccharide" class="doc_header"><code>characterize_monosaccharide</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/analysis.py#L177" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>characterize_monosaccharide</code>(<strong><code>sugar</code></strong>, <strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>'sugar'</code></em>, <strong><code>glycan_col_name</code></strong>=<em><code>'target'</code></em>, <strong><code>rank</code></strong>=<em><code>None</code></em>, <strong><code>focus</code></strong>=<em><code>None</code></em>, <strong><code>modifications</code></strong>=<em><code>False</code></em>, <strong><code>filepath</code></strong>=<em><code>''</code></em>, <strong><code>thresh</code></strong>=<em><code>10</code></em>)</p>
</blockquote>
<p>for a given monosaccharide/linkage, return typical neighboring linkage/monosaccharide</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">sugar (string): monosaccharide or linkage</td>
</tr>
<tr>
<td style="text-align:left">df (dataframe): dataframe to use for analysis; default:df_species</td>
</tr>
<tr>
<td style="text-align:left">mode (string): either 'sugar' (connected monosaccharides), 'bond' (monosaccharides making a provided linkage), or 'sugarbond' (linkages that a provided monosaccharides makes); default:'sugar'</td>
</tr>
<tr>
<td style="text-align:left">glycan_col_name (string): column name under which glycans can be found; default:'target'</td>
</tr>
<tr>
<td style="text-align:left">rank (string): add column name as string if you want to filter for a group</td>
</tr>
<tr>
<td style="text-align:left">focus (string): add row value as string if you want to filter for a group</td>
</tr>
<tr>
<td style="text-align:left">modifications (bool): set to True if you want to consider modified versions of a monosaccharide; default:False</td>
</tr>
<tr>
<td style="text-align:left">filepath (string): absolute path including full filename allows for saving the plot</td>
</tr>
<tr>
<td style="text-align:left">thresh (int): threshold count of when to include motifs in plot; default:10 occurrences</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Plots modification distribution and typical neighboring bond/monosaccharide</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">characterize_monosaccharide</span><span class="p">(</span><span class="s1">&#39;D-Rha&#39;</span><span class="p">,</span> <span class="n">rank</span> <span class="o">=</span> <span class="s1">&#39;Kingdom&#39;</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="s1">&#39;Bacteria&#39;</span><span class="p">,</span> <span class="n">modifications</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="annotate">annotate<a class="anchor-link" href="#annotate"> </a></h1><blockquote><p>extract curated motifs, graph features, and sequence features from glycan sequences</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="annotate_glycan" class="doc_header"><code>annotate_glycan</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/annotate.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>annotate_glycan</code>(<strong><code>glycan</code></strong>, <strong><code>motifs</code></strong>=<em><code>None</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>extra</code></strong>=<em><code>'termini'</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>, <strong><code>termini_list</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>searches for known motifs in glycan sequence</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): IUPAC-condensed glycan sequence</td>
</tr>
<tr>
<td style="text-align:left">motifs (dataframe): dataframe of glycan motifs (name + sequence); default:motif_list</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
<tr>
<td style="text-align:left">extra (string): 'ignore' skips this, 'wildcards' allows for wildcard matching', and 'termini' allows for positional matching; default:'termini'</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of wildcard names (such as 'bond', 'Hex', 'HexNAc', 'Sia')</td>
</tr>
<tr>
<td style="text-align:left">termini_list (list): list of monosaccharide/linkage positions (from 'terminal','internal', and 'flexible')</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe with absence/presence of motifs in glycan</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="annotate_dataset" class="doc_header"><code>annotate_dataset</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/annotate.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>annotate_dataset</code>(<strong><code>glycans</code></strong>, <strong><code>motifs</code></strong>=<em><code>None</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>feature_set</code></strong>=<em><code>['known']</code></em>, <strong><code>extra</code></strong>=<em><code>'termini'</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>, <strong><code>termini_list</code></strong>=<em><code>[]</code></em>, <strong><code>condense</code></strong>=<em><code>False</code></em>, <strong><code>estimate_speedup</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>wrapper function to annotate motifs in list of glycans</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycans (list): list of IUPAC-condensed glycan sequences as strings</td>
</tr>
<tr>
<td style="text-align:left">motifs (dataframe): dataframe of glycan motifs (name + sequence); default:motif_list</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our data; default:lib</td>
</tr>
<tr>
<td style="text-align:left">feature_set (list): which feature set to use for annotations, add more to list to expand; default is 'known'; options are: 'known' (hand-crafted glycan features), 'graph' (structural graph features of glycans) and 'exhaustive' (all mono- and disaccharide features)</td>
</tr>
<tr>
<td style="text-align:left">extra (string): 'ignore' skips this, 'wildcards' allows for wildcard matching', and 'termini' allows for positional matching; default:'termini'</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of wildcard names (such as 'bond', 'Hex', 'HexNAc', 'Sia')</td>
</tr>
<tr>
<td style="text-align:left">termini_list (list): list of monosaccharide/linkage positions (from 'terminal','internal', and 'flexible')</td>
</tr>
<tr>
<td style="text-align:left">condense (bool): if True, throws away columns with only zeroes; default:False</td>
</tr>
<tr>
<td style="text-align:left">estimate_speedup (bool): if True, pre-selects motifs for those which are present in glycans, not 100% exact; default:False</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe of glycans (rows) and presence/absence of known motifs (columns)</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glycans</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)][Xyl(b1-2)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-3)]GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Man(a1-2)Man(a1-2)Man(a1-3)[Man(a1-3)Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;GalNAc(a1-4)GlcNAcA(a1-4)[GlcN(b1-7)]Kdo(a2-5)[Kdo(a2-4)]Kdo(a2-6)GlcN4P(b1-6)GlcN4P&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Annotate Test&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">annotate_dataset</span><span class="p">(</span><span class="n">glycans</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_trisaccharides" class="doc_header"><code>get_trisaccharides</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/annotate.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_trisaccharides</code>(<strong><code>glycan</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>function to retrieve trisaccharides occurring in a glycan (probably incomplete)</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed nomenclature</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our data; default:lib</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of trisaccharides in glycan in IUPAC-condensed nomenclature</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_trisaccharides</span><span class="p">(</span><span class="s1">&#39;GalNAc(a1-4)GlcNAcA(a1-4)[GlcN(b1-7)]Kdo(a2-5)[Kdo(a2-4)]Kdo(a2-6)GlcN4P(b1-6)GlcN4P&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="graph">graph<a class="anchor-link" href="#graph"> </a></h1><blockquote><p>convert glycan sequences to graphs and contains helper functions to search for motifs / check whether two sequences describe the same sequence, etc.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="glycan_to_graph" class="doc_header"><code>glycan_to_graph</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L38" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>glycan_to_graph</code>(<strong><code>glycan</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>the monumental function for converting glycans into graphs</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): IUPAC-condensed glycan sequence (string)</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">(1) a list of labeled glycoletters from the glycan / node list</td>
</tr>
<tr>
<td style="text-align:left">(2) two lists to indicate which glycoletters are connected in the glycan graph / edge list</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Glycan to Graph&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glycan_to_graph</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_glycans" class="doc_header"><code>compare_glycans</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L175" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_glycans</code>(<strong><code>glycan_a</code></strong>, <strong><code>glycan_b</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>wildcards</code></strong>=<em><code>False</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>returns True if glycans are the same and False if not</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan_a (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">glycan_b (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
<tr>
<td style="text-align:left">wildcards (bool): set to True to allow wildcards (e.g., 'bond', 'monosaccharide'); default is False</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of indices for wildcards in libr</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns True if two glycans are the same and False if not</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Graph Isomorphism Test&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compare_glycans</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;Man(a1-6)[Man(a1-3)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fast_compare_glycans" class="doc_header"><code>fast_compare_glycans</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fast_compare_glycans</code>(<strong><code>g1</code></strong>, <strong><code>g2</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>wildcards</code></strong>=<em><code>False</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>returns True if glycans are the same and False if not</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">g1 (networkx object): glycan graph from glycan_to_nxGraph</td>
</tr>
<tr>
<td style="text-align:left">g2 (networkx object): glycan graph from glycan_to_nxGraph</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
<tr>
<td style="text-align:left">wildcards (bool): set to True to allow wildcards (e.g., 'bond', 'monosaccharide'); default is False</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of indices for wildcards in libr</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns True if two glycans are the same and False if not</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="subgraph_isomorphism" class="doc_header"><code>subgraph_isomorphism</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L220" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>subgraph_isomorphism</code>(<strong><code>glycan</code></strong>, <strong><code>motif</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>extra</code></strong>=<em><code>'ignore'</code></em>, <strong><code>wildcard_list</code></strong>=<em><code>[]</code></em>, <strong><code>termini_list</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>returns True if motif is in glycan and False if not</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">motif (string): glycan motif in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
<tr>
<td style="text-align:left">extra (string): 'ignore' skips this, 'wildcards' allows for wildcard matching', and 'termini' allows for positional matching; default:'ignore'</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list of wildcard names (such as 'bond', 'Hex', 'HexNAc', 'Sia')</td>
</tr>
<tr>
<td style="text-align:left">termini_list (list): list of monosaccharide/linkage positions (from 'terminal','internal', and 'flexible')</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns True if motif is in glycan and False if not</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subgraph Isomorphism Test&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subgraph_isomorphism</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Fuc(a1-6)GlcNAc&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="glycan_to_nxGraph" class="doc_header"><code>glycan_to_nxGraph</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L256" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>glycan_to_nxGraph</code>(<strong><code>glycan</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>termini</code></strong>=<em><code>'ignore'</code></em>, <strong><code>termini_list</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>converts glycans into networkx graphs</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
<tr>
<td style="text-align:left">termini (string): whether to encode terminal/internal position of monosaccharides, 'ignore' for skipping, 'calc' for automatic annotation, or 'provided' if this information is provided in termini_list; default:'ignore'</td>
</tr>
<tr>
<td style="text-align:left">termini_list (list): list of monosaccharide/linkage positions (from 'terminal','internal', and 'flexible')</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns networkx graph object of glycan</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="graph_to_string" class="doc_header"><code>graph_to_string</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L443" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>graph_to_string</code>(<strong><code>graph</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>converts glycan graph back to IUPAC-condensed format</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">graph (networkx object): glycan graph, works with branched glycans</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns glycan in IUPAC-condensed format (string)</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">graph_to_string</span><span class="p">(</span><span class="n">glycan_to_nxGraph</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Glycan to networkx Graph (only edges printed)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glycan_to_nxGraph</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_graph_features" class="doc_header"><code>generate_graph_features</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L283" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_graph_features</code>(<strong><code>glycan</code></strong>, <strong><code>glycan_graph</code></strong>=<em><code>True</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>label</code></strong>=<em><code>'network'</code></em>)</p>
</blockquote>
<p>compute graph features of glycan</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string or networkx object): glycan in IUPAC-condensed format (or glycan network if glycan_graph=False)</td>
</tr>
<tr>
<td style="text-align:left">glycan_graph (bool): True expects a glycan, False expects a network (from construct_network); default:True</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
<tr>
<td style="text-align:left">label (string): Label to place in output dataframe if glycan_graph=False; default:'network'</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns a pandas dataframe with different graph features as columns and glycan as row</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="try_string_conversion" class="doc_header"><code>try_string_conversion</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/graph.py#L517" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>try_string_conversion</code>(<strong><code>graph</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>check whether glycan graph describes a valid glycan</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">graph (networkx object): glycan graph, works with branched glycans</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns glycan in IUPAC-condensed format (string) if glycan is valid, otherwise returns None</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="processing">processing<a class="anchor-link" href="#processing"> </a></h1><blockquote><p>process IUPACcondensed glycan sequences into glycoletters etc.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_nomenclature" class="doc_header"><code>check_nomenclature</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L159" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_nomenclature</code>(<strong><code>glycan</code></strong>)</p>
</blockquote>
<p>checks whether the proposed glycan has the correct nomenclature for glycowork</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_nomenclature</span><span class="p">(</span><span class="s1">&#39;Glc(b1-4)Glc&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="small_motif_find" class="doc_header"><code>small_motif_find</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>small_motif_find</code>(<strong><code>glycan</code></strong>)</p>
</blockquote>
<p>processes IUPACcondensed glycan sequence (string) without splitting it into glycowords</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns string in which glycoletters are separated by asterisks</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small_motif_find</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="min_process_glycans" class="doc_header"><code>min_process_glycans</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>min_process_glycans</code>(<strong><code>glycan_list</code></strong>)</p>
</blockquote>
<p>converts list of glycans into a nested lists of glycoletters</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan_list (list): list of glycans in IUPAC-condensed format as strings</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of glycoletter lists</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">min_process_glycans</span><span class="p">([</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Man(a1-2)Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="motif_find" class="doc_header"><code>motif_find</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>motif_find</code>(<strong><code>glycan</code></strong>, <strong><code>exhaustive</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>processes IUPACcondensed glycan sequence (string) into glycowords</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">exhaustive (bool): True for processing glycans shorter than one glycoword</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of glycowords</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_glycans" class="doc_header"><code>process_glycans</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_glycans</code>(<strong><code>glycan_list</code></strong>, <strong><code>exhaustive</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>wrapper function to process list of glycans into glycowords</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan_list (list): list of IUPAC-condensed glycan sequences as strings</td>
</tr>
<tr>
<td style="text-align:left">exhaustive (bool): True for processing glycans shorter than one glycoword</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">returns nested list of glycowords for every glycan</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">process_glycans</span><span class="p">([</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Man(a1-2)Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_lib" class="doc_header"><code>get_lib</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_lib</code>(<strong><code>glycan_list</code></strong>, <strong><code>mode</code></strong>=<em><code>'letter'</code></em>, <strong><code>exhaustive</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>returns sorted list of unique glycoletters in list of glycans</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan_list (list): list of IUPAC-condensed glycan sequences as strings</td>
</tr>
<tr>
<td style="text-align:left">mode (string): default is letter for glycoletters; change to obtain glycowords</td>
</tr>
<tr>
<td style="text-align:left">exhaustive (bool): if True, processes glycans shorter than 1 glycoword; default is True</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns sorted list of unique glycoletters (strings) in glycan_list</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_lib</span><span class="p">([</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Man(a1-2)Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="expand_lib" class="doc_header"><code>expand_lib</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>expand_lib</code>(<strong><code>libr</code></strong>, <strong><code>glycan_list</code></strong>)</p>
</blockquote>
<p>updates libr with newly introduced glycoletters</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
<tr>
<td style="text-align:left">glycan_list (list): list of IUPAC-condensed glycan sequences as strings</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns new lib</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lib1</span> <span class="o">=</span> <span class="n">get_lib</span><span class="p">([</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Man(a1-2)Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">])</span>
<span class="n">lib2</span> <span class="o">=</span> <span class="n">expand_lib</span><span class="p">(</span><span class="n">lib1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">])</span>
<span class="n">lib2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="seed_wildcard" class="doc_header"><code>seed_wildcard</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L117" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>seed_wildcard</code>(<strong><code>df</code></strong>, <strong><code>wildcard_list</code></strong>, <strong><code>wildcard_name</code></strong>, <strong><code>r</code></strong>=<em><code>0.1</code></em>, <strong><code>col</code></strong>=<em><code>'target'</code></em>)</p>
</blockquote>
<p>adds dataframe rows in which glycan parts have been replaced with the appropriate wildcards</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">df (dataframe): dataframe in which the glycan column is called "target" and is the first column</td>
</tr>
<tr>
<td style="text-align:left">wildcard_list (list): list which glycoletters a wildcard encompasses</td>
</tr>
<tr>
<td style="text-align:left">wildcard_name (string): how the wildcard should be named in the IUPAC-condensed nomenclature</td>
</tr>
<tr>
<td style="text-align:left">r (float): rate of replacement, default is 0.1 or 10%</td>
</tr>
<tr>
<td style="text-align:left">col (string): column name for glycan sequences; default: target</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe in which some glycoletters (from wildcard_list) have been replaced with wildcard_name</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="presence_to_matrix" class="doc_header"><code>presence_to_matrix</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/processing.py#L141" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>presence_to_matrix</code>(<strong><code>df</code></strong>, <strong><code>glycan_col_name</code></strong>=<em><code>'target'</code></em>, <strong><code>label_col_name</code></strong>=<em><code>'Species'</code></em>)</p>
</blockquote>
<p>converts a dataframe such as df_species to absence/presence matrix</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">df (dataframe): dataframe with glycan occurrence, rows are glycan-label pairs</td>
</tr>
<tr>
<td style="text-align:left">glycan_col_name (string): column name under which glycans are stored; default:target</td>
</tr>
<tr>
<td style="text-align:left">label_col_name (string): column name under which labels are stored; default:Species</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns pandas dataframe with labels as rows and glycan occurrences as columns</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">presence_to_matrix</span><span class="p">(</span><span class="n">df_species</span><span class="p">[</span><span class="n">df_species</span><span class="o">.</span><span class="n">Order</span> <span class="o">==</span> <span class="s1">&#39;Fabales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
                         <span class="n">label_col_name</span> <span class="o">=</span> <span class="s1">&#39;Family&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="query">query<a class="anchor-link" href="#query"> </a></h1><blockquote><p>for interacting with the databases contained in glycowork, delivering insights for sequences of interest</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_insight" class="doc_header"><code>get_insight</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/query.py#L8" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_insight</code>(<strong><code>glycan</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>motifs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>prints out meta-information about a glycan</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">libr (list): library of monosaccharides; if you have one use it, otherwise a comprehensive lib will be used</td>
</tr>
<tr>
<td style="text-align:left">motifs (dataframe): dataframe of glycan motifs (name + sequence); default:motif_list</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test get_insight with &#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;&quot;</span><span class="p">)</span>
<span class="n">get_insight</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="glytoucan_to_glycan" class="doc_header"><code>glytoucan_to_glycan</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/query.py#L49" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>glytoucan_to_glycan</code>(<strong><code>ids</code></strong>, <strong><code>revert</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>interconverts GlyTouCan IDs and glycans in IUPAC-condensed</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ids (list): list of GlyTouCan IDs as strings (if using glycans instead, change 'revert' to True</td>
</tr>
<tr>
<td style="text-align:left">revert (bool): whether glycans should be mapped to GlyTouCan IDs or vice versa; default:False</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of either GlyTouCan IDs or glycans in IUPAC-condensed</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glytoucan_to_glycan</span><span class="p">([</span><span class="s1">&#39;G59003TN&#39;</span><span class="p">,</span> <span class="s1">&#39;G88185OE&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="tokenization">tokenization<a class="anchor-link" href="#tokenization"> </a></h1><blockquote><p>helper functions to map glycans (strings) to numbers that can be used by models</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="string_to_labels" class="doc_header"><code>string_to_labels</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>string_to_labels</code>(<strong><code>character_string</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>tokenizes word by indexing characters in passed library</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">character_string (string): string of characters to index</td>
</tr>
<tr>
<td style="text-align:left">libr (list): list of library items</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns indexes of characters in library</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string_to_labels</span><span class="p">([</span><span class="s1">&#39;Man&#39;</span><span class="p">,</span><span class="s1">&#39;a1-3&#39;</span><span class="p">,</span><span class="s1">&#39;Man&#39;</span><span class="p">,</span><span class="s1">&#39;a1-6&#39;</span><span class="p">,</span><span class="s1">&#39;Man&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pad_sequence" class="doc_header"><code>pad_sequence</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pad_sequence</code>(<strong><code>seq</code></strong>, <strong><code>max_length</code></strong>, <strong><code>pad_label</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>brings all sequences to same length by adding padding token</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">seq (list): sequence to pad (from string_to_labels)</td>
</tr>
<tr>
<td style="text-align:left">max_length (int): sequence length to pad to</td>
</tr>
<tr>
<td style="text-align:left">pad_label (int): which padding label to use</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns padded sequence</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pad_sequence</span><span class="p">(</span><span class="n">string_to_labels</span><span class="p">([</span><span class="s1">&#39;Man&#39;</span><span class="p">,</span><span class="s1">&#39;a1-3&#39;</span><span class="p">,</span><span class="s1">&#39;Man&#39;</span><span class="p">,</span><span class="s1">&#39;a1-6&#39;</span><span class="p">,</span><span class="s1">&#39;Man&#39;</span><span class="p">]),</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convert_to_counts_glycoletter" class="doc_header"><code>convert_to_counts_glycoletter</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convert_to_counts_glycoletter</code>(<strong><code>glycan</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>counts the occurrence of glycoletters in glycan</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dictionary with counts per glycoletter in a glycan</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="glycoletter_count_matrix" class="doc_header"><code>glycoletter_count_matrix</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>glycoletter_count_matrix</code>(<strong><code>glycans</code></strong>, <strong><code>target_col</code></strong>, <strong><code>target_col_name</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>creates dataframe of counted glycoletters in glycan list</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycans (list): list of glycans in IUPAC-condensed format as strings</td>
</tr>
<tr>
<td style="text-align:left">target_col (list or pd.Series): label columns used for prediction</td>
</tr>
<tr>
<td style="text-align:left">target_col_name (string): name for target_col</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe with glycoletter counts (columns) for every glycan (rows)</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_isomorphs" class="doc_header"><code>find_isomorphs</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_isomorphs</code>(<strong><code>glycan</code></strong>)</p>
</blockquote>
<p>returns a set of isomorphic glycans by swapping branches etc.</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of unique glycan notations (strings) for a glycan in IUPAC-condensed</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">find_isomorphs</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="link_find" class="doc_header"><code>link_find</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>link_find</code>(<strong><code>glycan</code></strong>)</p>
</blockquote>
<p>finds all disaccharide motifs in a glycan sequence using its isomorphs</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">glycan (string): glycan in IUPAC-condensed format</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of unique disaccharides (strings) for a glycan in IUPAC-condensed</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">link_find</span><span class="p">(</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="motif_matrix" class="doc_header"><code>motif_matrix</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L152" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>motif_matrix</code>(<strong><code>df</code></strong>, <strong><code>glycan_col_name</code></strong>, <strong><code>label_col_name</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>generates dataframe with counted glycoletters and disaccharides in glycans</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">df (dataframe): dataframe containing glycan sequences and labels</td>
</tr>
<tr>
<td style="text-align:left">glycan_col_name (string): column name for glycan sequences</td>
</tr>
<tr>
<td style="text-align:left">label_col_name (string): column name for labels; string</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe with glycoletter + disaccharide counts (columns) for each glycan (rows)</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glycans</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Man(a1-3)[Man(a1-6)][Xyl(b1-2)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-3)]GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Man(a1-2)Man(a1-2)Man(a1-3)[Man(a1-3)Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc&#39;</span><span class="p">,</span>
           <span class="s1">&#39;GalNAc(a1-4)GlcNAcA(a1-4)[GlcN(b1-7)]Kdo(a2-5)[Kdo(a2-4)]Kdo(a2-6)GlcN4P(b1-6)GlcN4P&#39;</span><span class="p">]</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;glycan&#39;</span><span class="p">:</span><span class="n">glycans</span><span class="p">,</span> <span class="s1">&#39;eukaryotic&#39;</span><span class="p">:</span><span class="n">label</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Glyco-Motif Test&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">motif_matrix</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="s1">&#39;glycan&#39;</span><span class="p">,</span> <span class="s1">&#39;eukaryotic&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_composition" class="doc_header"><code>match_composition</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L311" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_composition</code>(<strong><code>composition</code></strong>, <strong><code>group</code></strong>, <strong><code>level</code></strong>, <strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>'minimal'</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>glycans</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Given a monosaccharide composition, it returns all corresponding glycans</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">composition (dict): a dictionary indicating the composition to match (for example {"Fuc":1, "Gal":1, "GlcNAc":1})</td>
</tr>
<tr>
<td style="text-align:left">group (string): name of the Species, Genus, Family, Order, Class, Phylum, Kingdom, or Domain used to filter</td>
</tr>
<tr>
<td style="text-align:left">level (string): Species, Genus, Family, Order, Class, Phylum, Kingdom, or Domain</td>
</tr>
<tr>
<td style="text-align:left">df (dataframe): glycan dataframe for searching glycan structures; default:df_species</td>
</tr>
<tr>
<td style="text-align:left">mode (string): can be "minimal" or "exact" to match glycans that contain at least the specified composition or glycans matching exactly the requirements</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset; default:lib</td>
</tr>
<tr>
<td style="text-align:left">glycans (list): custom list of glycans to check the composition in; default:None</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of glycans matching composition in IUPAC-condensed</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">match_composition</span><span class="p">({</span><span class="s2">&quot;Glc&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Gal&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Neu5Ac&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="s2">&quot;Homo_sapiens&quot;</span><span class="p">,</span> <span class="s2">&quot;Species&quot;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_composition_relaxed" class="doc_header"><code>match_composition_relaxed</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L391" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_composition_relaxed</code>(<strong><code>composition</code></strong>, <strong><code>group</code></strong>, <strong><code>level</code></strong>, <strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>'exact'</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>reducing_end</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Given a coarse-grained monosaccharide composition (Hex, HexNAc, etc.), it returns all corresponding glycans</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">composition (dict): a dictionary indicating the composition to match (for example {"Fuc":1, "Gal":1, "GlcNAc":1})</td>
</tr>
<tr>
<td style="text-align:left">group (string): name of the Species, Genus, Family, Order, Class, Phylum, Kingdom, or Domain used to filter</td>
</tr>
<tr>
<td style="text-align:left">level (string): Species, Genus, Family, Order, Class, Phylum, Kingdom, or Domain</td>
</tr>
<tr>
<td style="text-align:left">df (dataframe): glycan dataframe for searching glycan structures; default:df_species</td>
</tr>
<tr>
<td style="text-align:left">mode (string): can be "minimal" or "exact" to match glycans that contain at least the specified composition or glycans matching exactly the requirements; default:"exact"</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset; default:lib</td>
</tr>
<tr>
<td style="text-align:left">reducing_end (string): filters possible glycans by reducing end monosaccharide; default:None</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns list of glycans matching composition in IUPAC-condensed</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">match_composition_relaxed</span><span class="p">({</span><span class="s2">&quot;Hex&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;HexNAc&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;dHex&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="s2">&quot;Homo_sapiens&quot;</span><span class="p">,</span> <span class="s2">&quot;Species&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="condense_composition_matching" class="doc_header"><code>condense_composition_matching</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L448" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>condense_composition_matching</code>(<strong><code>matched_composition</code></strong>, <strong><code>libr</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Given a list of glycans matching a composition, find the minimum number of glycans characterizing this set</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">matched_composition (list): list of glycans matching to a composition</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset; default:lib</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns minimal list of glycans that match a composition</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">match_comp</span> <span class="o">=</span> <span class="n">match_composition_relaxed</span><span class="p">({</span><span class="s1">&#39;Hex&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;HexNAc&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Neu5Ac&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="s1">&#39;Homo_sapiens&#39;</span><span class="p">,</span> <span class="s1">&#39;Species&#39;</span><span class="p">,</span> <span class="n">reducing_end</span> <span class="o">=</span> <span class="s1">&#39;GalNAc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">match_comp</span><span class="p">)</span>
<span class="n">condense_composition_matching</span><span class="p">(</span><span class="n">match_comp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compositions_to_structures" class="doc_header"><code>compositions_to_structures</code><a href="https://github.com/BojarLab/glycowork/tree/master/glycowork/motif/tokenization.py#L483" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compositions_to_structures</code>(<strong><code>composition_list</code></strong>, <strong><code>abundances</code></strong>, <strong><code>group</code></strong>, <strong><code>level</code></strong>, <strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>libr</code></strong>=<em><code>None</code></em>, <strong><code>reducing_end</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>wrapper function to map compositions to structures, condense them, and match them with relative intensities</p>
<table>
<thead><tr>
<th style="text-align:left">Arguments:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">composition_list (list): list of composition dictionaries of the form {'Hex': 1, 'HexNAc': 1}</td>
</tr>
<tr>
<td style="text-align:left">abundances (dataframe): every row one glycan (matching composition_list in order), every column one sample; pd.DataFrame([range(len(composition_list))]*2).T if not applicable</td>
</tr>
<tr>
<td style="text-align:left">group (string): name of the Species, Genus, Family, Order, Class, Phylum, Kingdom, or Domain used to filter</td>
</tr>
<tr>
<td style="text-align:left">level (string): Species, Genus, Family, Order, Class, Phylum, Kingdom, or Domain</td>
</tr>
<tr>
<td style="text-align:left">df (dataframe): glycan dataframe for searching glycan structures; default:df_species</td>
</tr>
<tr>
<td style="text-align:left">libr (list): sorted list of unique glycoletters observed in the glycans of our dataset; default:lib</td>
</tr>
<tr>
<td style="text-align:left">reducing_end (string): filters possible glycans by reducing end monosaccharide; default:None</td>
</tr>
<tr>
<td style="text-align:left">verbose (bool): whether to print any non-matching compositions; default:False</td>
</tr>
</tbody>
</table>
<table>
<thead><tr>
<th style="text-align:left">Returns:</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Returns dataframe of (matched structures) x (relative intensities)</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

